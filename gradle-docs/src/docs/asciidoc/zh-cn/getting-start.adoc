[[start]]
== 入门指南

[[start-getting-start]]
=== 入门指南

每个人都必须从某个地方开始，如果您是Gradle的新手，那么这就是开始的地方。

[[start-getting-start-before]]
==== 开始之前

为了有效地使用 Gradle，您需要了解 Gradle 是什么并了解其一些基本概念。因此，在您开始认真使用 Gradle 之前，我们强烈建议您阅读 <<about-gradle>>。

即使您有使用 Gradle 的经验，我们还是建议您阅读 <<about-gradle-five>>，因为它可以消除一些常见的误解。

[[start-installing-gradle]]
==== 安装 gradle

您可以在 Linux，macOS 或 Windows 上安装 Gradle 构建工具。 本文档覆盖了使用像 SDKMAN!,Homebrew 这样的软件包管理器以及手动安装

建议使用 <<reference-wrapper,Gradle Wrapper>> 升级 Gradle。

您可以在 https://gradle.org/releases/[releases page] 上找到所有版本及其校验。

[[start-installing-gradle-prerequisites]]
===== 先决条件

Gradle 可在所有主要操作系统上运行，并且仅需要 Java Development Kit 版本 8 或更高版本即可运行。要进行检查，请运行 `java -version`。您应该会看到以下内容：

[source,shell]
----
❯ java -version
java version "1.8.0_151"
Java(TM) SE Runtime Environment (build 1.8.0_151-b12)
Java HotSpot(TM) 64-Bit Server VM (build 25.151-b12, mixed mode)
----

Gradle 附带了自己的 Groovy 库，因此不需要安装 Groovy。 Gradle 将忽略任何现有的 Groovy 安装。

Gradle 使用在路径中找到的任何 JDK。另外，您可以将 `JAVA_HOME` 环境变量设置为指向所需 JDK 的安装目录。

<<start-compatibility-matrix,请参阅Java，Groovy，Kotlin 和 Android 的完整兼容性说明。>>

[[start-installing-gradle-package]]
===== 使用软件包管理器进行安装

https://sdkman.io/[SDKMAN!] 是用于在大多数类 Unix 系统（macOS，Linux，Cygwin，Solaris 和 FreeBSD）上管理多个软件开发套件的并行版本的工具。我们部署并维护可从 SDKMAN! 获得的版本。

[source,shell]
----
 sdk install gradle
----

https://brew.sh/[Homebrew] 是 "macOS缺少的软件包管理器"。

[source,shell]
----
brew install gradle
----

可以使用其他软件包管理器，但是它们分发的 Gradle 版本不受 Gradle, Inc. 的控制。Linux 软件包管理器可能会分发与正式版本相比不兼容或不完整的 Gradle 修改版(从 SDKMAN! 或更低版本提供)。

<<start-installing-gradle-next,下一步>>

[[start-installing-gradle-manually]]
===== 手动安装

*Step1 https://gradle.org/releases/[下载] 最新的Gradle发行版*::
发行的ZIP文件有两种形式：
* Binary-only(bin): 仅有可运行的二进制文件
* Complete(all) with docs and sources: 附带文档和源码
如需使用旧版本，请参阅 https://gradle.org/releases/[releases page]

*Step2 解压*::
* Linux 和 MacOS 用户
+
在您选择的目录中解压缩发行版zip文件，例如：
+
[source,shell]
----
❯ mkdir /opt/gradle
❯ unzip -d /opt/gradle gradle-6.6.1-bin.zip
❯ ls /opt/gradle/gradle-6.6.1
LICENSE NOTICE bin README init.d lib media
----
* Microsoft Windows 用户
+
使用文件资源管理器创建一个新目录 `C:\Gradle`。
+
打开第二个“文件资源管理器”窗口，然后转到下载 Gradle 发行版的目录。双击ZIP存档以显示内容。将内容文件夹 `gradle-6.6.1` 拖到新创建的 `C:\Gradle` 文件夹中。
+
另外，您可以使用压缩工具将 Gradle 发行版 ZIP 解压至 `C:\Gradle`。

*Step3 配置系统环境*::
要运行 Gradle，从 Gradle 网站到解压缩文件的路径必须在您的终端路径上。对于每个操作系统，执行此操作的步骤都不同。
* Linux 和 MacOS 用户
+
配置 `PATH` 环境变量以包含解压后的 Gradle 的 `bin` 目录，例如：
+
[source,shell]
----
❯ export PATH=$PATH:/opt/gradle/gradle-6.6.1/bin
----
+
或者，您也可以添加环境变量 `GRADLE_HOME` 并将其指向解压后的文件夹。可以将 `$GRADLE_HOME/bin` 添加到 `PATH`，而不是将特定版本的 `Gradle` 添加到 `PATH`。
升级到其他版本的 `Gradle` 时，只需更改 `GRADLE_HOME` 环境变量即可。
* Microsoft Windows 用户
+
在文件资源管理器中，右键单击 "此电脑(或我的电脑)" 图标，然后单击 `属性`→`高级系统设置`→`环境变量`。
+
在 "系统变量" 下，选择 `Path`，然后单击 `编辑` 。为 `C:\Gradle\gradle-6.6.1\bin` 添加一个条目。单击确定保存。
+
或者，您也可以添加环境变量 `GRADLE_HOME` 并将其指向解压后的文件夹。可以将 `％GRADLE_HOME％/bin` 添加到您的 `Path` 中，而不是将特定版本的 `Gradle` 添加到 `Path` 中。升级到其他版本的 `Gradle` 时，只需更改 `GRADLE_HOME` 环境变量即可。

<<start-installing-gradle-next,下一步>>


[[start-getting-verifying]]
==== 验证安装

打开控制台（或 Windows 命令提示符）并运行 `gradle -v` 以运行 gradle 并显示版本，例如：

[source,shell]
----
❯ gradle -v
------------------------------------------------------------
Gradle 6.6.1
------------------------------------------------------------
(environment specific information)
----

如果遇到任何麻烦，请参阅 <<start-troubleshooting-builds-installation>>部分。

您可以通过下载 SHA-256 文件（可从 https://gradle.org/releases/[releases page] 中获得）并按照以下 <<reference-wrapper-customizing-verification,验证指示信息来验证>> Gradle 发行版的完整性。

[[start-installing-gradle-next]]
==== 下一步

现在您已经安装了 Gradle，请使用以下资源进行入门:

* 按照 https://guides.gradle.org/creating-new-gradle-builds/[Creating New Gradle Builds] 教程创建第一个Gradle项目。
* 注册 https://gradle.com/training/[Gradle 现场入门培训] 与资深工程师交流。
* 了解如何通过 <<reference-command>> 完成常见任务。
* <<running-environment,配置 Gradle 环境>>，例如使用 HTTP 代理下载依赖项。
* 订阅 https://newsletter.gradle.com/[Gradle Newsletter] 以获取每月发布和社区更新。

[[start-troubleshooting-builds]]
=== 故障排除

以下是常见问题的集合以及解决这些问题的建议。您可以在 https://discuss.gradle.org/c/help-discuss/14[Gradle forums] , https://stackoverflow.com/questions/tagged/gradle[StackOverflow#gradle] 或者 https://help.gradle.org/[help.gradle.org] 的Gradle文档获取其他提示。

[[start-troubleshooting-builds-installation]]
==== Gradle 安装中的问题

如果您按照 <<start-installing-gradle,安装说明进行操作>>，但无法执行 Gradle 构建，则以下一些提示可能会有所帮助。

如果在调用 Gradle Wrapper 之外安装了 Gradle，则可以通过在终端中运行 `gradle --version` 来检查 Gradle 的安装。

您应该会看到以下内容：

[source,shell]
----
gradle --version
------------------------------------------------------------
Gradle 6.5
------------------------------------------------------------
Build time: 2020-06-02 20:46:21 UTC
Revision: a27f41e4ae5e8a41ab9b19f8dd6d86d7b384dad4
Kotlin: 1.3.72
Groovy: 2.5.11
Ant: Apache Ant(TM) version 1.10.7 compiled on September 1 2019
JVM: 14 (AdoptOpenJDK 14+36)
OS: Mac OS X 10.15.2 x86_64
----

如果没有，您可能会看到一些其他的东西。

* *Command not found: gradle*
+
如果提示 `command not found: gradle`，则需要确保 Gradle 已正确添加到 `PATH` 中。

* *JAVA_HOME is set to an invalid directory*
+
如果你获取到如下错误提示
+
[source,shell]
----
ERROR: JAVA_HOME is set to an invalid directory
Please set the JAVA_HOME variable in your environment to match the location of your
Java installation.
----
+
您需要确保正确 https://www.java.com/en/download/help/index_installing.html[安装] 了 https://jdk.java.net/[Java Development Kit 8] 或更高版本，已设置 `JAVA_HOME` 环境变量，并将 https://www.java.com/en/download/help/path.html[Java 添加到 PATH 中]。

* *Permission denied*
+
如果提示 "Permission denied"，则表示 Gradle 可能存在于正确的位置，但不可执行。您可以在 `*nix-based` 的系统上使用 `chmod +x path/to/executable` 来解决此问题。

* *其他安装失败*
+
如果 `gradle --version` 工作正常，但是所有构建都因相同的错误而失败，则其中一个 Gradle 构建配置脚本可能存在问题。
+
您可以通过运行执行配置脚本但不执行 Gradle 任务的 `gradle help` 来验证问题是否出在 Gradle 脚本上。如果错误仍然存​​在，则构建配置存在问题。如果不是，则问题在于执行一个或多个请求的任务（Gradle 首先执行配置脚本，然后执行构建步骤）。

[[start-troubleshooting-debug-dependency]]
==== 调试依赖项解析

<<dependency-learning-view-debugging,解决依赖性冲突>>章节中涵盖了常见的依赖性问题，例如解决版本冲突。

通过单击 `Dependencies view` 并使用搜索功能，并指定解析原因，您可以看到依赖关系树，并查看哪些已解析的依赖关系版本与请求的版本有所不同。

image::images/gradle-004.png[]

可以使用带有筛选条件的 https://scans.gradle.com/s/woivcb4z67b42/dependencies[实际构建扫描] 进行探索。

[[start-troubleshooting-slow]]
==== 对缓慢的 Gradle 构建进行故障排除

有关构建性能问题（包括 "同步速度慢"），请参阅 https://guides.gradle.org/performance/[Improving the Performance of Gradle Builds(《提高Gradle构建的性能指南》)]。

Android 开发人员应观看 Android SDK 工具团队的 https://youtu.be/7ll-rkLCtyk[Speeding Up Your Android Gradle Builds(有关加速 Android Gradle 构建)]的演示。 Android Studio 用户指南还介绍了许多有关 https://developer.android.com/studio/build/optimize-your-build.html[优化构建速度] 的技巧。

[[start-troubleshooting-debug-logic]]
==== 调试构建逻辑

* 将调试器附加到构建
+
您可以通过将 `org.gradle.debug` 属性设置为 `true`，然后将远程调试器附加到端口 `5005`，来设置断点并在 Gradle 构建自身中调试 <<extending-plugins-packaging,buildSrc 和 standalone plugins>>。
+
[source,shell]
----
gradle help -Dorg.gradle.debug=true
----
+
此外，如果您采用了 Kotlin DSL，则还可以自己调试构建脚本。
+
以下视频演示了如何使用 IntelliJ IDEA 调试示例构建。
+
image::images/remote-debug-gradle.gif[]

* *添加和更改日志记录*
+
除了 <<reference-command-logging,控制日志记录>>的详细程度之外，您还可以使用 `--console=verbose flag` 控制生命周期日志记录中任务结果的显示（例如“UP-TO-DATE”）。
+
您还可以通过注册各种事件侦听器，以自己的方式替换 Gradle 的许多日志记录。日志记录文档中说明了一个 <<authoring-logging-changing,自定义事件记录器>>的示例。您还可以从 <<authoring-logging-external-tools,外部工具>>控制日志记录，使它们更加冗长，以便调试其执行。
+
[NOTE]
====
Gradle守护程序的其他日志可以在 `GRADLE_USER_HOME/daemon/<gradle-version>/` 下找到
====

* *应该在 UP-TO-DATE 执行的任务*
+
`--info` 日志说明了执行任务的原因，尽管构建扫描通过以一种可搜索的可视方式执行此操作，方法是转到“时间轴”视图，然后单击要检查的任务。
+
image::images/troubleshooting-task-execution-build-scan.png[]
+
您可以从此 <<authoring-tasks-outcomes,清单>>中了解任务结果的含义。

* *调试 IDE 集成*
+
可以通过 "refreshing" Gradle 解决 IDE 中许多不常见的错误。另请参阅有关在 https://www.jetbrains.com/help/idea/gradle.html[IntelliJ IDEA] 和 https://www.vogella.com/tutorials/EclipseGradle/article.html[Eclipse] 中使用 Gradle 的更多文档。

* *Refreshing IntelliJ IDEA*
+
[NOTE]
====
注意： 这仅适用于链接到 IntelliJ 的 Gradle 项目。
====
+
在主菜单中，转到 `View > Tool Windows > Gradle`。然后单击 _Refresh_ 图标。
+
image::images/troubleshooting-refresh-intellij.png[]

* *Refreshing Eclipse (using Buildship)*
+
如果您正在为 Eclipse IDE 使用 https://projects.eclipse.org/projects/tools.buildship[Buildship]，您可以通过打开 "Gradle Tasks" 视图并单击 _Refresh_ 图标来重新同步您的 Gradle 构建，
或者通过在编辑 Gradle 脚本时从上下文菜单中执行 `Gradle > Refresh Gradle Project` 命令来重新同步。
+
image::images/troubleshooting-refresh-eclipse.png[]

* *获得更多帮助*
+
如果您在此处未找到解决问题的方法，请在 https://discuss.gradle.org/c/help-discuss/14[帮助论坛] 上与 Gradle 社区联系，或使用 https://gradle.org/help/[help.gradle.org] 搜索相关的开发人员资源。
+
如果您认为自己在 Gradle 中发现了错误，请在 GitHub上 https://github.com/gradle/gradle/issues[提交问题]。

[[start-compatibility-matrix]]
=== 兼容性

[[start-compatibility-matrix-java]]
==== Java

执行 Gradle 需要 Java8-14 之间的版本。 Java 15 和更高版本尚未支持。

Java 6和7仍可用于编译和测试执行。

任何受支持的 Java 版本都可以用于编译或测试

[[start-compatibility-matrix-kotlin]]
==== Kotlin

Gradle 已通过 Kotlin 1.3.21 至 1.3.72 进行了测试。

[[start-compatibility-matrix-groovy]]
==== Groovy

Gradle 已通过 Groovy 1.5.8 至 2.5.12 进行了测试。

[[start-compatibility-matrix-android]]
==== Android

Gradle 已通过 Android Gradle 插件 3.4、3.5、3.6 和 4.0 进行了测试。 Alpha 和 Beta 版本可能会不起作用。